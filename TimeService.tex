\subsection{Сервис времени}

Ранее упоминалось, что доказательства имеют право на существование в том случае, если время, с которым потоки поступают в очередь, не убывает. На практике обеспечить такое поведение в распределенной системе с использованием встроенных в язык средств практически невозможно: время на серверах может рассинхронизироваться, в результате чего несколько реплик могут убежать вперед на несколько минут, несколько реплик могут отстать на несколько минут. Для решения этой проблемы был реализован сервис, который гарантированно будет отдавать неубывающее значение времени.

Суть сервиса очень простая: он имеет несколько реплик, каждая из которых периодически пытается обновить значение текущего времени в специально заведенной под эти цели ячейке в Cassandra. При обновлении реплика берет локальное текущее время в микросекундах, сравнивает его со значением, лежащим в Cassandra, и если значение в ячейке меньше локального времени, то ячейка просто переписывается с новым значением.