%% LaTeX Beamer presentation template (requires beamer package)
%% see http://latex-beamer.sourceforge.net/
%% idea contributed by H. Turgut Uyar
%% template based on a template by Till Tantau
%% this template is still evolving - it might differ in future releases!

\documentclass[cp1251]{beamer}

\mode<presentation>
{
\usetheme{Darmstadt}
\setbeamercovered{transparent}
} 

\usepackage[english,russian]{babel}
\usepackage{pgf}
\usepackage{tikz}
\usepackage{multicol}
\usepackage{listings}
\lstloadlanguages{XML,Java}
\lstset{language=Java,
		extendedchars=true,
		escapechar=|,
		frame=tb,
		commentstyle=\itshape,
		stringstyle=\bfseries,
		basicstyle=\ttfamily\scriptsize,
		breaklines=true}


\title{Реализация алгоритма распределенной блокировки на основе БД Cassandra}

\author{Денис Мухаметьянов}

\date{9 июня 2015}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

\section{Блокировка}

\begin{frame}[fragile]
	\begin{block}{Снятие денег с банковского счета}
		\begin{lstlisting}[language=Java]
   Узнать текущий баланс
   Если баланс больше или равен запрашиваемой сумме:
   	Уменьшить баланс на запрашиваемую сумму
   	Сообщить об успешном проведении операции
   Иначе:
   	Сообщить о том, что средств недостаточно
		\end{lstlisting}
	\end{block}
\end{frame}

\begin{frame}[fragile]
	\begin{block}{Механизм блокировки}
		\begin{itemize}
			\pause
			\item Предоставление исключительного доступа к разделяемому ресурсу для множества потоков
			\pause
			\item Реализован в большинстве современных языков программирования в рамках одного процесса
		\end{itemize}
	\end{block}
\end{frame}

\section{Распределенная блокировка}

\begin{frame}[fragile]
	\begin{block}{Распределенная система}
	\pause
		\begin{itemize}
			\item Существует множество серверов, на которых запущены компоненты системы
			\pause
			\item Механизмы, реализованные в языках программирования, не подходят
		\end{itemize}
	\end{block}
\end{frame}

\begin{frame}[fragile]
	\begin{block}{}
		\begin{center}
			Необходим механизм предоставления исключительного доступа с разных серверов
		\end{center}
	\end{block}
\end{frame}

\begin{frame}[fragile]
	\begin{block}{Google Chubby}
		\begin{itemize}
			\pause
			\item Подробно описанная технология
			\pause
			\item Реализация закрыта
			\pause
		\end{itemize}
	\end{block}

	\begin{block}{Apache ZooKeeper}
		\begin{itemize}
			\pause
			\item Открытый исходный код
			\pause
			\item Нет готового клиента для C\#
			\pause
		\end{itemize}
	\end{block}

	\begin{block}{}
		Нужно собственное решение
	\end{block}
\end{frame}

\section{Алгоритм}

\begin{frame}[fragile]
	\begin{block}{Старый алгоритм}
	\pause
		\begin{itemize}
			\item Использует особенности хранения разреженной таблицы в Cassandra
			\pause
			\item Корректно решает поставленную задачу
			\pause
			\item Неравномерно распределяет блокировки между потоками
		\end{itemize}
	\end{block}
\end{frame}

\begin{frame}[fragile]
	\begin{block}{Новый алгоритм}
	\pause
		\begin{itemize}
			\item Использует особенности хранения разреженной таблицы в Cassandra
			\pause
			\item Выстраивает потоки в очередь в строке
			\pause
			\item Распределяет блокировку между потоками в порядке этой очереди
			\pause
			\item Не ухудшил производительность
			\pause
			\item Корректно решает поставленную задачу
		\end{itemize}
	\end{block}
\end{frame}

\begin{frame}[fragile]
	\begin{block}{}
		\begin{itemize}
			\item Алгоритм реализован на C\#
			\pause
			\item Проведено модульное и нагрузочное тестирование
			\pause
			\item Проведено сравнение производительности со старым алгоритмом
		\end{itemize}
	\end{block}
\end{frame}

\begin{frame}[fragile]
	\begin{block}{Результаты сравнения производительности}
		\begin{itemize}
			\pause
			\item Среднее время ожидания освобождения блокировки не ухудшилось
			\pause
			\item Потоки захватывают блокировки равномерно
		\end{itemize}
	\end{block}
\end{frame}

\begin{frame}[fragile]
	\begin{figure}[h!]
	  \caption{Моменты взятия блокировок старым алгоритмом}
	  \centering
	    \includegraphics[height=7cm]{5_old.png}
	\end{figure}
\end{frame}

\begin{frame}[fragile]
	\begin{figure}[h!]
	  \caption{Моменты взятия блокировок новым алгоритмом}
	  \centering
	    \includegraphics[height=7cm]{5_new.png}
	\end{figure}
\end{frame}

\begin{frame}[fragile]
	\begin{figure}[h!]
	  \caption{Время взятия мягкой блокировки}
	  \centering
	    \includegraphics[height=7cm]{queue_like.png}
	\end{figure}
\end{frame}

\section{Планы на будущее}

\begin{frame}[fragile]
	\begin{block}{}
		\begin{itemize}
			\pause
			\item Внедрение нового алгоритма в проект
			\pause
			\item Снижение среднего времени ожидания блокировки
		\end{itemize}
	\end{block}
\end{frame}
\end{document}